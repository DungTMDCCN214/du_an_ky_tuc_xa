<!-- accounts/templates/accounts/student_dashboard.html -->
{% extends 'base.html' %}

{% block title %}Dashboard Sinh viÃªn{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>ğŸ“ Dashboard Sinh viÃªn</h1>
    <span class="badge bg-success fs-6">Sinh viÃªn</span>
</div>

<div class="row">
    <!-- ThÃ´ng tin sinh viÃªn -->
    <div class="col-md-4">
        <div class="card">
            <div class="card-header bg-primary text-white">
                <h5>ğŸ‘¤ ThÃ´ng tin cÃ¡ nhÃ¢n</h5>
            </div>
            <div class="card-body">
                <p><strong>MÃ£ SV:</strong> {{ student.student_id|default:"ChÆ°a cáº­p nháº­t" }}</p>
                <p><strong>Há» tÃªn:</strong> {{ student.full_name|default:student.user.get_full_name }}</p>
                <p><strong>Email:</strong> {{ student.user.email }}</p>
                <p><strong>TrÆ°á»ng:</strong> {{ student.university|default:"ChÆ°a cáº­p nháº­t" }}</p>
                <p><strong>Khoa:</strong> {{ student.faculty|default:"ChÆ°a cáº­p nháº­t" }}</p>
                <p><strong>KhÃ³a:</strong> {{ student.course|default:"ChÆ°a cáº­p nháº­t" }}</p>
                
                {% if not student.student_id %}
                <div class="alert alert-warning mt-3">
                    <small>âš ï¸ Vui lÃ²ng cáº­p nháº­t thÃ´ng tin sinh viÃªn</small>
                    <br>
                    <a href="{% url 'student_complete_profile' %}" class="btn btn-sm btn-warning mt-2">Cáº­p nháº­t há»“ sÆ¡</a>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="col-md-8">
        <!-- Há»£p Ä‘á»“ng hiá»‡n táº¡i -->
        {% if current_contract %}
        <div class="card mb-4">
            <div class="card-header bg-success text-white">
                <h5>âœ… Há»£p Ä‘á»“ng hiá»‡n táº¡i</h5>
            </div>
            <div class="card-body">
                <p><strong>Sá»‘ há»£p Ä‘á»“ng:</strong> {{ current_contract.contract_number }}</p>
                <p><strong>PhÃ²ng:</strong> {{ current_contract.room.building.name }} - PhÃ²ng {{ current_contract.room.room_number }}</p>
                <p><strong>Loáº¡i phÃ²ng:</strong> {{ current_contract.room.room_type.name }}</p>
                <p><strong>GiÃ¡ thuÃª:</strong> {{ current_contract.room.room_type.price_per_month|floatformat:0 }} VNÄ/thÃ¡ng</p>
                <p><strong>NgÃ y báº¯t Ä‘áº§u:</strong> {{ current_contract.start_date|date:"d/m/Y" }}</p>
                <p><strong>NgÃ y káº¿t thÃºc:</strong> {{ current_contract.end_date|date:"d/m/Y" }}</p>
            </div>
        </div>
        {% else %}
        <div class="card mb-4">
            <div class="card-header bg-warning text-dark">
                <h5>ğŸ“ ÄÄƒng kÃ½ PhÃ²ng KÃ½ tÃºc xÃ¡</h5>
            </div>
            <div class="card-body text-center">
                <p>Báº¡n chÆ°a cÃ³ há»£p Ä‘á»“ng thuÃª phÃ²ng. HÃ£y Ä‘Äƒng kÃ½ phÃ²ng kÃ½ tÃºc xÃ¡ ngay!</p>
                <a href="#available-rooms" class="btn btn-primary">Xem phÃ²ng trá»‘ng</a>
            </div>
        </div>
        {% endif %}

        <!-- PhÃ²ng trá»‘ng -->
        <div class="card">
            <div class="card-header">
                <h5 id="available-rooms">ğŸ  PhÃ²ng trá»‘ng hiá»‡n cÃ³</h5>
            </div>
            <div class="card-body">
                {% if available_rooms %}
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>TÃ²a nhÃ </th>
                                <th>PhÃ²ng</th>
                                <th>Loáº¡i phÃ²ng</th>
                                <th>Sá»©c chá»©a</th>
                                <th>GiÃ¡/thÃ¡ng</th>
                                <th>Thao tÃ¡c</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for room in available_rooms %}
                            <tr>
                                <td>{{ room.building.name }}</td>
                                <td>{{ room.room_number }}</td>
                                <td>{{ room.room_type.name }}</td>
                                <td>{{ room.room_type.capacity }} ngÆ°á»i</td>
                                <td>{{ room.room_type.price_per_month|floatformat:0 }} VNÄ</td>
                                <td>
                                    <a href="{% url 'room_booking' room.pk %}" class="btn btn-sm btn-success">ğŸ“ ÄÄƒng kÃ½</a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <p class="text-muted">Hiá»‡n khÃ´ng cÃ³ phÃ²ng trá»‘ng.</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}